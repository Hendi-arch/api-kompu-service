# Production profile overrides
# Minimal overrides â€” production values should generally come from environment variables or a secrets manager.

# Datasource - require environment values in production
spring.datasource.url=${SPRING_DATASOURCE_URL:}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.maximum-pool-size=${DB_MAX_POOL_SIZE:50}
spring.datasource.hikari.minimum-idle=${DB_MIN_IDLE:10}
spring.datasource.hikari.connection-timeout=${DB_CONNECTION_TIMEOUT:30000}
spring.datasource.hikari.max-lifetime=${DB_MAX_LIFETIME:1800000}

# JPA / Hibernate - be strict in production
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=${SPRING_JPA_DATABASE_PLATFORM:org.hibernate.dialect.PostgreSQLDialect}
spring.jpa.properties.hibernate.type.json_format_mapper=com.kompu.api.infrastructure.config.web.response.WebJacksonJsonFormatMapper

# Logging
logging.level.root=INFO
logging.level.com.kompu=INFO

# Actuator - limit exposed endpoints in prod (use gateway/ingress auth)
management.endpoints.web.exposure.include=health,info,metrics,prometheus,loggers
management.endpoint.health.show-details=when-authorized
management.endpoint.shutdown.enabled=false

# Eureka Client (Prod)
eureka.client.enabled=${EUREKA_CLIENT_ENABLED:true}
eureka.client.serviceUrl.defaultZone=${EUREKA_SERVER_URL:}
eureka.client.healthcheck.enabled=true
eureka.client.registryFetchIntervalSeconds=${EUREKA_FETCH_INTERVAL:30}
eureka.client.leaseRenewalIntervalInSeconds=${EUREKA_RENEWAL_INTERVAL:30}
eureka.instance.hostname=${EUREKA_INSTANCE_HOSTNAME:}
eureka.instance.preferIpAddress=${EUREKA_PREFER_IP_ADDRESS:true}
eureka.instance.metadata-map.version=${project.version:1.0.0}

# Security / secrets note
# Ensure `SPRING_DATASOURCE_PASSWORD`, `JWT_SECRET`, and SSL keystore passwords
# are provided via environment variables or a secrets manager; do NOT commit them.

# Mail (Prod) - ensure valid SMTP details are provided via env vars
spring.mail.host=${SPRING_MAIL_HOST:}
spring.mail.port=${SPRING_MAIL_PORT:}
spring.mail.username=${SPRING_MAIL_USERNAME:}
spring.mail.password=${SPRING_MAIL_PASSWORD:}

# File Storage (Prod) - ideally use S3/MinIO, but if local, specify path
app.storage.local.upload-dir=${APP_STORAGE_LOCAL_UPLOAD_DIR:/var/lib/kompu/uploads}
